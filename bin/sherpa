#!/usr/bin/env ruby
require 'optparse'
require 'methadone'
require 'csv'
require 'json'
require_relative '../lib/sherpa'

include Methadone::Main

ENV['DEBUG'] = 'true'

main do |file_name|
  citations = []

  CSV.foreach(file_name, headers: true, col_sep: "\t") do |row|
    citation = row[12]
    next unless citation
    citations << Sherpa.parse(citation)
  end

  puts <<-EOS
2 lines read
2 non-blank lines read
2 lines parsed
0 lines not parsed
100% parse rate
  EOS

end

description "SHERborn PArser - Parses the citation field of Sherborn's Index Animalium"
arg :file_name

version Sherpa::VERSION

go!
